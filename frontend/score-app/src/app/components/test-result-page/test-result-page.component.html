<ng-container
  *ngTemplateOutlet="isNewTest ? newTest : viewTestResult"
></ng-container>

<ng-template #newTest>
  <section>
    <div>
      <label [htmlFor]="'companyName'">Company name:</label>
      <input
        pInputText
        [id]="'companyName'"
        [formControlName]="'companyName'"
      />
    </div>

    <p-dropdown
      [options]="tests"
      [(ngModel)]="selectedTest"
      optionLabel="name"
      [showClear]="true"
      placeholder="Select a Test"
      (onChange)="onTestItemClick($event)"
    ></p-dropdown>
  </section>

  <section>
    <div>
      <ng-container *ngIf="!testDone && !!selectedTest">
        <div>
          <p>
            Question {{ currentCriteriaIndex + 1}} /
            {{ selectedTest?.criterias?.length }}
          </p>
        </div>
        <div class="answers-container">
          <ng-container
            *ngFor="
              let answer of selectedTest?.criterias?.[currentCriteriaIndex].answers;
              let i = index
            "
          >
            <div class="answer">
              {{ answer.text }}
            </div>
          </ng-container>
        </div>
        <div>
          <p-button
            *ngIf="currentCriteriaNextIndex < selectedTest?.criterias?.length && selectedTest?.criterias?.length !== 1"
            label="Next"
            (onClick)="onNextQuestion()"
          ></p-button>
          <p-button
            *ngIf="currentCriteriaNextIndex === selectedTest?.criterias?.length || selectedTest?.criterias?.length === 1"
            label="Done"
            (onClick)="onDoneTest()"
          ></p-button>
        </div>
      </ng-container>
      <ng-container *ngIf="testDone"> done </ng-container>
    </div>
  </section>
</ng-template>

<ng-template #viewTestResult>
  {{ currentTestResult | json }}
</ng-template>

<ng-template #done> done </ng-template>
